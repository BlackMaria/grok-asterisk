ASTLEVEL (?:VERBOSE|ERROR|NOTICE|INFO|DEBUG|DTMF|WARNING)
ASTLANGUAGE [a-z]{1,3}
# Special pattern for "Ext." Logs
ASTEXTNO [A-Za-z0-9_]+
# Log source file (Normally a c file)
ASTSRC [-a-z._0-9/]+
# Context
ASTCONTEXTEXTENSION [A-Za-z0-9*#~]+
ASTCONTEXTNAME [-a-z0-9]+
ASTCONTEXTPOSITION \d+
ASTCONTEXT %{ASTCONTEXTEXTENSION}@%{ASTCONTEXTNAME}:%{ASTCONTEXTPOSITION}
# Application
ASTAPP [A-Z][A-Za-z0-9]+
ASTAPP_PARAMS "[^"]*"
ASTAPP_AUDIOFILE [-a-zA-Z0-9_.]+
# Channels
ASTCHANNEL_SIP SIP/[a-z0-9]+-[a-f0-9]+
ASTCHANNEL_LOCAL Local/[-a-z0-9@;]+
ASTCHANNEL (:?%{ASTCHANNEL_SIP}|%{ASTCHANNEL_LOCAL})
# Different log content types
ASTCONTENT_EXECUTE Executing \[%{ASTCONTEXT}\] %{ASTAPP}\("%{ASTCHANNEL}", %{ASTAPP_PARAMS}\)
ASTCONTENT_CHANNELJUMP Channel '%{ASTCHANNEL}' jumping out of macro '%{ASTCONTEXTNAME}'
ASTCONTENT_GOTO Goto \(%{ASTCONTEXTNAME},%{ASTCONTEXTEXTENSION},%{ASTCONTEXTPOSITION}\)
ASTCONTENT_SIPCOSMARK Using SIP RTP CoS mark %{NUMBER}
ASTCONTENT_UNIXCONNECTION Remote UNIX connection (:?dis)?connected
ASTCONTENT_LOGGER Asterisk Queue Logger restarted
ASTCONTENT_PLAYAUDIO <%{ASTCHANNEL}> Playing '%{ASTAPP_AUDIOFILE}' \(language '%{ASTLANGUAGE}'\)
ASTCONTENT_DTMF DTMF (:?begin|end)(:? passthrough| ignored)? '%{NUMBER:DTMF_NUMBER}'(:? received)? on %{ASTCHANNEL}(:?, duration %{NUMBER:DTMF_DURATION} ms)?
ASTCONTENT [-=\s]*(:?%{ASTCONTENT_EXECUTE}|%{ASTCONTENT_CHANNELJUMP}|%{ASTCONTENT_GOTO}|%{ASTCONTENT_UNIXCONNECTION}|%{ASTCONTENT_PLAYAUDIO}|%{ASTCONTENT_DTMF}|%{ASTCONTENT_SIPCOSMARK}|%{ASTCONTENT_LOGGER}|%{GREEDYDATA})
# different log types
ASTLOG1 \[%{TIMESTAMP_ISO8601}\] %{ASTLEVEL}\[\d+\] %{ASTSRC}:%{ASTCONTENT}
ASTLOG2 \[%{TIMESTAMP_ISO8601}\] %{ASTLEVEL}\[\d+\] Ext. %{ASTEXTNO}: %{GREEDYDATA}
ASTTIMEOUT Packet timed out after %{NUMBER}ms with no response
ASTLOG ^(:?%{ASTLOG1}|%{ASTLOG2}|%{ASTTIMEOUT})